<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Station Identity manager</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="yogoko.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="https://www.yogoko.com/"><img height="40px" src="yogoko-logo-svg-fr-white.png" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">YoGoKo Smart Middleware</span></p>
              <ul id="yogoko-navlist" class="nav navbar-nav"></ul>
              <form id="yogoko-searchform" class="navbar-form navbar-left navbar-right hidden-sm hidden-xs">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('identitymanager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Station Identity manager </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The IdentityManager is the central element for management of the Station identity and C-ITS security in YoGoKo C-ITS Stack.</p>
<p>It stores, manages, and relays various elements related to the identity of the station and its security parameters.</p>
<p>The IdentityManager is commonly supplemented with a Security Client to connect YoGoKo Middleware to a C-ITS security implementation (e.g. YoGoKo PKIService or Preserve Service), in order to enable C-ITS security in the middleware.</p>
<h1>Processing and IO</h1>
<p>The IdentityManager retrieves station identifiers and security parameters either from its configuration, or from a SecurityClient.</p>
<p>When using YoGoKo Security Client, the SecurityClient collects security parameters from Itsnet and from the PKIService (1) and provides it to the IdentityManager (2). See details in section <em><b>Retrieving of station and security parameters</b></em>.</p>
<p>The IdentityManager distributes identity and security parameters to Facilities services and Applications (3). See details in section <em><b>Provision of security parameters</b></em>.</p>
<p>Facilities services and Applications may request Identity changes to be locked (4). The locking request is relayed to the Security Client (5), to be then passed to the PKI Service (6). See details in section <em><b>ID change locking</b></em>.</p>
<div class="image">
<img src="flow-identitymanager.png" alt="flow-identitymanager.png"/>
<div class="caption">
IdentityManager</div></div>
 <h2>Retrieving of station and security parameters</h2>
<p>The IdentityManager maintains an up to date representation of station and security parameters, based on several sources.</p>
<p>When security is disabled, the IdentityManager basically read station parameters from the configuration file (<code>identity.stationid</code> and <code>identity.stationtype</code>). If the <code>identity.idchangeenabled</code> flag is true, a user may also update these parameters by pushing a configuration update.</p>
<p>When security is enabled and a security client service is configured, the IdentityManager may receive station parameters from a security service. A security service may lock the emission of outgoing messages in order to prevent emission of inconsistent messages while a pseudonym is being rotated. If the <code>identity.idchangeenabled</code> flag is true, a security service may also update the station parameters and the AIDs and associated SSPs.</p>
<h2>Provision of security parameters</h2>
<p>The IdentityManager provides to Facilities services and Applications the current station identity and security parameters that it collects and maintains.</p>
<p>The IdentityManager provides to Facilities services (CaService, DenService, etc) inside the C-ITS stack a consistent state of security parameters, allowing them to reliably and securely send signed or unsigned messages, and to react accordingly on pseudonym rotation or on station identity changes. The mentionned security parameters include the current configuration of IdentityManager (e.g. <code>security.signmessages</code>, <code>security.locked</code>), making emission of messages from facility services fully controlled by the IdentityManager and its configuration.</p>
<p>For services executed outside the middleware, a consistent state of security parameters may also be retrieved by performing a MIB request on the IdentityManager service.</p>
<p>For compatibility reasons, the IdentityManager additionally publishes the status of dynamic security parameters on the station parameters cache. This behavior will be maintained in future versions. However, this cache may not be fully consistent since it may be filled simultaneously by both the IdentityManager and by security services.</p>
<h2>ID change locking</h2>
<p>In some cases, a service may request identity parameters of the station to remain stable for some time. This is especially the case when a message (e.g. a DENM) is triggered for a given duration, in which situation identity change must be locked to prevent a change of the DENM actionID.</p>
<p>Facilities services or Applications which needs identity change to be locked may inform the IdentityManager by setting the MIB variable <code>identity.lockid</code> to true. When the IdentityManager receives such a request, it increases the <code>identity.idlocks</code> counter, tracking the number of services that requested ID change locking. When this counter is non-zero, identity change locking is notified by setting the variable <code>lockid</code> to true in the Identity cache. Inversely, the lock may then be released by setting <code>identity.lockid</code> to false, in which case the <code>identity.idlocks</code> counter is decreased and, if this counter is zero, identity change unlocking is notified in the Identity cache as well.</p>
<p>On reading, the MIB variable <code>identity.lockid</code> will always reflect the current status of ID locking. That is, issueing a <code>identity.lockid=true</code> request to increment the <code>identity.idlocks</code> counter while the <code>identity.lockid</code> MIB variable is already true, is definitely not an error. Similarly, reading the <code>identity.lockid</code> variable after issueing a <code>identity.lockid=false</code> request will not necessarily return false.</p>
<p><b>Note:</b> Beware that there is no control on applications that manipulate the <code>identity.lockid</code> variable. It is up to application developers to keep track of whether they did or did not issue a successfull locking request, and to appropriately issue unlocking requests. A failure in doing so may lead to an unexpected behavior.</p>
<p>When security is enabled and a Security client is active, ID locking status is read by the Security client to inform the PKI client that pseudonym rotations must be blocked until unlocking.</p>
<h1>Configuration and MIBs</h1>
<h2>List of MIB entries</h2>
<p>Details of MIB entries:</p>
<table class="doxtable">
<tr>
<th>Section </th><th>Field </th><th>R/W </th><th>Type </th><th>Default value </th><th>Description  </th></tr>
<tr>
<td>choir </td><td>applicationid </td><td>RW </td><td>integer </td><td>10 </td><td>App ID to subscribe with </td></tr>
<tr>
<td>choir </td><td>identitycacheid </td><td>RW </td><td>integer </td><td>0 </td><td>Cache ID of Station parameters cache </td></tr>
<tr>
<td>identity </td><td>stationid </td><td>RW </td><td>integer </td><td>(random) </td><td>Static Station ID </td></tr>
<tr>
<td>identity </td><td>stationtype </td><td>RW </td><td>integer </td><td>0 </td><td>Static Station Type </td></tr>
<tr>
<td>identity </td><td>idchangeenabled </td><td>RW </td><td>boolean </td><td>false </td><td>Permission to modify station parameters </td></tr>
<tr>
<td>identity </td><td>lockid </td><td>RW </td><td>boolean </td><td>false </td><td>Lock ID change and pseudonym rotation </td></tr>
<tr>
<td>identity </td><td>idlocks </td><td>R </td><td>integer </td><td>0 </td><td>Number of ID locks currently pending </td></tr>
<tr>
<td>security </td><td>enabled </td><td>RW </td><td>boolean </td><td>false </td><td>Whether or not to enable ITS security </td></tr>
<tr>
<td>security </td><td>signmessages </td><td>RW </td><td>boolean </td><td>false </td><td>Whether or not to sign outgoing ITS messages </td></tr>
<tr>
<td>security </td><td>locked </td><td>RW </td><td>boolean </td><td>false </td><td>Whether or not emission of messages is currently forbidden </td></tr>
<tr>
<td>aids </td><td>count </td><td>R </td><td>integer </td><td>0 </td><td>Obsolete, ignored </td></tr>
<tr>
<td>aid&lt;n&gt; </td><td>aid </td><td>R </td><td>integer </td><td>- </td><td>Obsolete, ignored </td></tr>
<tr>
<td>aid&lt;n&gt; </td><td>ssp </td><td>R </td><td>binary </td><td>- </td><td>Obsolete, ignored </td></tr>
</table>
<p>Note: For now, AIDs and SSPs may not be set by configuration. This means that a security client service must currently be integrated inside the middleware to be fully functional. This behavior may change in a future version.</p>
<h2>Sample configuration file</h2>
<p><em><b>config/10-identity.xml</b></em></p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div><div class="line">&lt;<span class="keywordtype">configuration</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">service</span> <span class="keyword">start</span>=<span class="stringliteral">&quot;true&quot;</span> <span class="keyword">instance</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;<span class="keyword">IdentityManager</span>&lt;/<span class="keywordtype">service</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">config</span>&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Message Id for choir protocol</span></div><div class="line"><span class="comment">             Note: The identitycacheid entry must not be set to the same value as the</span></div><div class="line"><span class="comment">             choir.securitycacheid MIB entry from the SecurityClient service. Such a</span></div><div class="line"><span class="comment">             situation would lead to an interlocking --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">choir</span> <span class="keyword">applicationid</span>=<span class="stringliteral">&quot;10&quot;</span> <span class="keyword">identitycacheid</span>=<span class="stringliteral">&quot;0&quot;</span> /&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Station identity parameters and configuration</span></div><div class="line"><span class="comment">             stationid: Manually defined station id of the station (default is random)</span></div><div class="line"><span class="comment">             stationtype: Station type of the station</span></div><div class="line"><span class="comment">             idchangeenabled: Whether or not Station ID change is allowed</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">identity</span> <span class="keyword">stationid</span>=<span class="stringliteral">&quot;1234&quot;</span></div><div class="line">                  <span class="keyword">stationtype</span>=<span class="stringliteral">&quot;5&quot;</span></div><div class="line">                  <span class="keyword">idchangeenabled</span>=<span class="stringliteral">&quot;true&quot;</span> /&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Security configuration</span></div><div class="line"><span class="comment">             enabled: Whether or not security is enabled</span></div><div class="line"><span class="comment">             signmessages: Whether or not outgoing messages should be signed</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">security</span> <span class="keyword">enabled</span>=<span class="stringliteral">&quot;false&quot;</span></div><div class="line">                  <span class="keyword">signmessages</span>=<span class="stringliteral">&quot;true&quot;</span> /&gt;</div><div class="line"></div><div class="line">    &lt;/<span class="keywordtype">config</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">configuration</span>&gt;</div></div><!-- fragment --><h2>Moved configuration parameters</h2>
<p>Parameters managed by the IdentityManager were formerly dispatched in several files, either in the choirconf.xml or in facility services configuration files (caservice.xml, denservice.xml, etc):</p><ul>
<li>The station ID and the station type parameters were configured in the choirconf.xml configuration file</li>
<li>The idchange flag and the security enabled flag were configured in the choirconf.xml configuration file</li>
<li>The choir appid and identifiers to retrieve security parameters were configured per-facility service configuration file</li>
<li>The signmessages flag to enable message signing was configured per-facility service configuration file</li>
</ul>
<p>By centralizing these parameters in the IdentityManager, the number of configuration files to change when enabling security is reduced. As a consequence, the behaviors controlled by these parameters cannot be set per-facility anymore.</p>
<p>Only the following parameters remain per-facilities :</p><ul>
<li>securityparameters.securitycontrol: may be used to bypass SSP checks in emission and reception</li>
<li>securityparameters.aid: Application ID to be used to sign messages emitted by the facility service </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Tue Mar 14 2023 16:13:25 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="yogoko-doxy.js"></script>
  </body>
</html>
