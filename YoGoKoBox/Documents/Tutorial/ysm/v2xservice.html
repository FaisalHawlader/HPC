<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>V2X Service</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="yogoko.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="https://www.yogoko.com/"><img height="40px" src="yogoko-logo-svg-fr-white.png" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">YoGoKo Smart Middleware</span></p>
              <ul id="yogoko-navlist" class="nav navbar-nav"></ul>
              <form id="yogoko-searchform" class="navbar-form navbar-left navbar-right hidden-sm hidden-xs">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('v2xservice.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">V2X Service </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The V2X Service is a Network/Transport service in charge of sending and receiving packets from/to lower layers (Geonetworking, WAVE or IPv6).</p>
<p>The V2XService does not implement these protocols itself but forwards packets to the appropriate daemon or system call.</p>
<p>In most setups, ITS messaging facilities (CaService, DenService, SpatService, IviService, FrameService) use this service for sending packets through the geonetworking protocol or the WAVE protocol.</p>
<h1>Processing and I/O</h1>
<p>The V2X Service provides protocol handlers for gn and ip6 sockets:</p><ul>
<li>The gn protocol is implemented by passing packets from/to the itsnet daemon. Packets are sent either through a choir IPC connection or a tun interface, according to the configuration and system setup.</li>
<li>The ip6 protocol is implemented using IPv6 sockets (UDP or TCP).</li>
</ul>
<h2>Itsnet sockets (choiritsnet, previously choirgn )</h2>
<p>The choiritsnet protocol handler uses a choir IPC connection to communicate with the itsnet daemon. The itsnet daemon must be configured accordingly to use this connection.</p>
<p>On emission, packets are published to the choiritsnet&lt;n&gt;.sendmsgid message id. Metadata entries are associated to the packet to pass parameters from the Facility service to itsnet depending on messages protocol family :</p><ul>
<li>for EU messages : type of GN packet, destination area, ...</li>
<li>for US messages : messageId, PSID</li>
</ul>
<p>On reception, choiritsnet subscribes to the choiritsnet&lt;n&gt;.recvmsgid message id. As for emission, Metadata entries are set by itsnet to pass parameters associated to this packet from itsnet to the Facility service.</p>
<p>When enabled, the choirgn protocol handler registers the following socket protocols:</p>
<table class="doxtable">
<tr>
<th>Scheme </th><th>Accepted notations </th><th>Description  </th></tr>
<tr>
<td>gn+btp </td><td>gn+btp://&lt;channel&gt;:&lt;port&gt; </td><td>Receive and send packets through a Geonetworking network protocol and BTP-B transport protocol </td></tr>
<tr>
<td>btp </td><td>btp://&lt;channel&gt;:&lt;port&gt; </td><td>Alias for gn+btp </td></tr>
<tr>
<td>wsmp </td><td>wsmp://cch: </td><td>Receive and send packets through a WSMP network protocol </td></tr>
</table>
<h2>GN sockets (mwtun)</h2>
<p>The mwtun protocol handler uses a tun interface to communicate with the itsnet daemon. The itsnet daemon must be configured accordingly to create and use the tun interface for communication with the upper layer. The configuration specifies whether a header should be prepended to the packet to pass Geonetworking parameters.</p>
<p>On emission, messages are sent as IPv6 UDP packets on the tun interface, with the UDP port set to the BTP port of the GN packet to send. According to the configuration, they may or may not have a header prepended to the message. If enabled, the header contains the Geonetworking parameters. If disabled, the packet is sent by default as a GN TSB packet.</p>
<p>On reception, messages are received as IPv6 UDP packets from the tun interface, on the UDP port configured to listen on. As for emission, if the header is enabled, mwtun will extract Geonetworking parameters specified in this header. If disabled, packets are sent on the tun interface regardedless of their type, and mwtun will not fill Geonetworking parameters. As for emission, the IPv6 UDP port is used as the BTP port.</p>
<p>When enabled, the mwtun protocol handler registers the following socket protocols:</p>
<table class="doxtable">
<tr>
<th>Scheme </th><th>Accepted notations </th><th>Description  </th></tr>
<tr>
<td>gn+btp </td><td>gn+btp://&lt;channel&gt;:&lt;port&gt; </td><td>Receive and send packets through a Geonetworking network protocol and BTP-B transport protocol </td></tr>
<tr>
<td>btp </td><td>btp://&lt;channel&gt;:&lt;port&gt; </td><td>Alias for gn+btp </td></tr>
</table>
<h2>IPv6 sockets</h2>
<p>The IPv6 protocol handler sends and receives packets through an IPv6 UDP or TCP socket. It is equivalent to using java DatagramSocket, MulticastSocket, ServerSocket or Socket classes. According to the protocol (UDP or TCP) and type of address, the IPv6 protocol handler selects the appropriate method for communicating on the socket.</p>
<p>By default, sockets are opened in client mode. By appending the flag <em><b>listen=1</b></em>, the socket will be opened in server/listen mode. If a multicast IPv6 address is provided, the IPv6 protocol handler will join the multicast group.</p>
<p>When enabled, the ip6 protocol handler registers the following socket protocols:</p>
<table class="doxtable">
<tr>
<th>Scheme </th><th>Accepted notations </th><th>Description  </th></tr>
<tr>
<td>ip6+udp </td><td>ip6+udp://[&lt;addr&gt;]:&lt;port&gt; <br />
 ip6+udp://[&lt;addr&gt;]:&lt;port&gt;?reconnect=1 <br />
 ip6+udp://[&lt;addr&gt;]:&lt;port&gt;?listen=1 <br />
 ip6+udp://[&lt;addr&gt;%&lt;iface&gt;]:&lt;port&gt; <br />
 ip6+udp://[&lt;addr&gt;%&lt;iface&gt;]:&lt;port&gt;?reconnect=1 <br />
 ip6+udp://[&lt;addr&gt;%&lt;iface&gt;]:&lt;port&gt;?listen=1 </td><td>Receive and send packets through an IPv6 UDP socket, may use IPv6 multicast addresses </td></tr>
<tr>
<td>ipv6+udp </td><td>see ip6+udp </td><td>Alias for ip6+udp </td></tr>
<tr>
<td>udp6 </td><td>see ip6+udp </td><td>Alias for ip6+udp </td></tr>
<tr>
<td>ip6+tcp </td><td>- </td><td>Not implemented yet </td></tr>
<tr>
<td>ipv6+tcp </td><td>- </td><td>Alias for ip6+tcp </td></tr>
<tr>
<td>tcp6 </td><td>- </td><td>Alias for ip6+tcp </td></tr>
</table>
<h1>Configuration and MIBs</h1>
<h2>List of MIB entries</h2>
<p>Details of MIB entries:</p>
<table class="doxtable">
<tr>
<th>Section </th><th>Field </th><th>Description </th><th>Default value  </th></tr>
<tr>
<td>ipv6 </td><td>enabled </td><td>Whether the IPv6 protocol handler shall be enabled </td><td>false </td></tr>
<tr>
<td>choiritsnet&lt;n&gt; </td><td>channel </td><td>Name of the channel to register (cch, sch1, ...) </td><td></td></tr>
<tr>
<td>choiritsnet&lt;n&gt; </td><td>recvmsgid </td><td>Message ID to subscribe to for receiving messages </td><td></td></tr>
<tr>
<td>choiritsnet&lt;n&gt; </td><td>sendmsgid </td><td>Message ID to publish to when sending messages </td><td></td></tr>
<tr>
<td>choiritsnet&lt;n&gt; </td><td>appid </td><td>Application ID to register </td><td></td></tr>
<tr>
<td>choirgn&lt;n&gt; </td><td>channel </td><td>(deprectaed)Name of the channel to register (cch, sch1, ...) </td><td></td></tr>
<tr>
<td>choirgn&lt;n&gt; </td><td>recvmsgid </td><td>(deprectaed)Message ID to subscribe to for receiving messages </td><td></td></tr>
<tr>
<td>choirgn&lt;n&gt; </td><td>sendmsgid </td><td>(deprectaed)Message ID to publish to when sending messages </td><td></td></tr>
<tr>
<td>choirgn&lt;n&gt; </td><td>appid </td><td>(deprecated) Application ID to register </td><td></td></tr>
<tr>
<td>mwtun&lt;n&gt; </td><td>channel </td><td>Name of the channel to register (cch, sch1, ...) </td><td></td></tr>
<tr>
<td>mwtun&lt;n&gt; </td><td>iface </td><td>Tun interface to send/receive messages </td><td></td></tr>
<tr>
<td>mwtun&lt;n&gt; </td><td>group </td><td>IPv6 multicast group (address) to use for sending and receiving on the tun interface </td><td></td></tr>
<tr>
<td>mwtun&lt;n&gt; </td><td>header </td><td>Whether a header should be prepended to packets (should always be set to true) </td><td>false </td></tr>
</table>
<p>Note: The usage of several instances of choiritsnet or mwtun protocol handlers, or mixing choiritsnet and mwtun on the same system has not been tested and not guarranted to work. As a consequence, the system currently supports GN on only one channel at a time. The configuration has been made more flexible in order to allow future extensions.</p>
<h2>Sample configuration file</h2>
<p><em><b>config/10-v2xservice.xml</b></em></p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div><div class="line">&lt;<span class="keywordtype">configuration</span>&gt;</div><div class="line">    <span class="comment">&lt;!--</span></div><div class="line"><span class="comment">        V2X service</span></div><div class="line"><span class="comment">        Register handlers for GN and IPv6 protocols</span></div><div class="line"><span class="comment">    --&gt;</span></div><div class="line">    &lt;<span class="keywordtype">service</span> <span class="keyword">start</span>=<span class="stringliteral">&quot;true&quot;</span> <span class="keyword">instance</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;<span class="keyword">V2XService</span>&lt;/<span class="keywordtype">service</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">config</span>&gt;</div><div class="line">        <span class="comment">&lt;!-- Enable IPv6 protocol handler (reasonable defaults) --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">ipv6</span> <span class="keyword">enabled</span>=<span class="stringliteral">&quot;true&quot;</span> /&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- mwtun GN protocol handler (reasonable defaults) --&gt;</span></div><div class="line">        <span class="comment">&lt;!-- &lt;mwtun1 channel=&quot;cch&quot; iface=&quot;tun0&quot; group=&quot;ff02::1234&quot; header=&quot;true&quot; /&gt; --&gt;</span></div><div class="line"></div><div class="line">        <span class="comment">&lt;!--  Enable choirgn (reasonable defaults) --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">choiritsnet1</span> <span class="keyword">channel</span>=<span class="stringliteral">&quot;cch&quot;</span> <span class="keyword">appid</span>=<span class="stringliteral">&quot;83&quot;</span> <span class="keyword">sendmsgid</span>=<span class="stringliteral">&quot;12&quot;</span> <span class="keyword">recvmsgid</span>=<span class="stringliteral">&quot;11&quot;</span> /&gt;</div><div class="line">    &lt;/<span class="keywordtype">config</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">configuration</span>&gt;</div><div class="line"></div></div><!-- fragment --><h1>Usage examples</h1>
<p>Some examples of GN and IPv6 ItsSocket URIs are provides below:</p><ul>
<li><em><b>gn+btp://cch:2001</b></em> - Open a GN/BTP socket on channel cch and BTP port 2001 (for sending and receiving CAM messages)</li>
<li><em><b>ip6+udp://[ff02::1:2:3:4v2x1]:1234</b></em> - Open a link-local multicast IPv6 UDP socket on interface v2x1 and port 1234 (for IPv6 over 802.11p communications)</li>
<li><em><b>ip6+udp://[fd00:a:b:c::1]:1234?listen=1</b></em> - Open an IPv6 UDP socket waiting for incomming connections on address fd00:a:b:c::1 and port 1234</li>
<li><em><b>ip6+udp://[fd00:a:b:c::1]:1234?reconnect=1</b></em> - Open an IPv6 UDP socket connecting to address fd00:a:b:c::1 and port 1234 </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Tue Mar 14 2023 16:13:24 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="yogoko-doxy.js"></script>
  </body>
</html>
