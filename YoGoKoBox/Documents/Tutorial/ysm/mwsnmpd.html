<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Mwsnmpd</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="yogoko.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="https://www.yogoko.com/"><img height="40px" src="yogoko-logo-svg-fr-white.png" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">YoGoKo Smart Middleware</span></p>
              <ul id="yogoko-navlist" class="nav navbar-nav"></ul>
              <form id="yogoko-searchform" class="navbar-form navbar-left navbar-right hidden-sm hidden-xs">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mwsnmpd.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Mwsnmpd </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Overview</h1>
<p><b>mwsnmpd</b> is a POSIX daemon meant for integration with SNMP monitoring.</p>
<p><b>mwsnmpd</b> acts as a bridge that translates SNMP requests to YoGoKo Middleware MIB configuration requests. It relies on YoGoKo Middleware and on the Net-SNMP daemon to operate. Both daemons must be running and appropriately configured for making mwsnmpd to work.</p>
<p><b>mwsnmpd</b> is connected to the Net-SNMP daemon using the SNMP AgentX extension protocol. On startup, it registers to snmpd with the list of OID it requests to be delegator for. On request on one of these OIDs, mwsnmpd performs a MIB configuration request on YoGoKo Middleware on the corresponding service and key. These mappings are controlled by mwsnmpd.conf configuration file.</p>
<p>The following figure describes the interaction of mwsnmpd with the Net-SNMP daemon and the YoGoKo Middleware.</p>
<div class="image">
<img src="YSM_mwsnmpd.png" alt="YSM_mwsnmpd.png"/>
<div class="caption">
Operation of the mwsnmpd daemon</div></div>
 <h1>MIB Mappings</h1>
<p>The mwsnmpd daemon supports several types of mappings:</p><ul>
<li><b>Service List</b>: The service list mapping presents as a SNMP table the list of services declared to the YoGoKo Middleware, with their status.</li>
<li><b>Service MIBs</b>: The service MIBs mapping presents as a SNMP table the list of offline MIB variables (configurations) for each service declared to the YoGoKo Middleware.</li>
<li><b>Mappings</b>: The mappings performs a direct one-to-one SNMP OID to YoGoKo Middleware MIB relation, on online MIB variables (statistics).</li>
</ul>
<h1>Configuration</h1>
<p>The setup of mwsnmpd relies on the SNMP MIB configuration and the mwsnmpd configuration.</p>
<p><b>SNMP MIB definition</b></p>
<p>The SNMP MIB definition includes the SNMP definition of the variables to be monitored. This definition file is either defined by standards such as IETF RFC documents, or a proprietary definition shared between the embedded system and the monitoring system. This definition must be structured in conformance with the SMIv2 standard (RFC 2578).</p>
<p>YoGoKo's proprietary SNMP MIB is provided in the YoGoKo SDK as YOGOKO-SNMP-MIB, it is defined under YoGoKo's Private Enterprise Number OID <em><b>1.3.6.1.4.1.54224</b></em>. This SNMP MIB is defined consistently with mwsnmpd.conf default configuration file.</p>
<p>Users may define their own SNMP MIB definition under their own Private Enterprise Number OID or under an experimental OID, and adapt the mwsnmpd.conf configuration file accordingly.</p>
<p>The SNMP MIB definition is not strictly necessary to make mwsnmpd to work, and is not required as an argument to the mwsnmpd command. However it is strongly recommended.</p>
<p><b>mwsnmpd configuration</b></p>
<p>The <em><b>mwsnmpd.conf</b></em> file is the configuration file of the mwsnmpd daemon.</p>
<p>It commands the SNMP OIDs mwsnmpd must register on, and the mappings between SNMP OIDs and YoGoKo Middleware configuration variables.</p>
<p>The following directives are supported:</p><ul>
<li><em><b>prefix</b></em>: set the prefix OID for later commands</li>
<li><em><b>service_list</b></em>: set OID for the service table</li>
<li><em><b>service_mibs</b></em>: set OID for the mibs table</li>
<li><em><b>mapping</b></em>: declare a MIB mapping</li>
</ul>
<p>The syntax of these directives are detailled in the example configuration file below.</p>
<p><em><b>mwsnmpd.conf</b></em></p>
<div class="fragment"></div><!-- fragment --><h1>Running mwsnmpd</h1>
<p><b>Using systemd</b></p>
<p>Start mwsnmpd:</p>
<p><code># systemctl start mwsnmpd</code></p>
<p>Stop mwsnmpd:</p>
<p><code># systemctl stop mwsnmpd</code></p>
<p>Restart mwsnmpd:</p>
<p><code># systemctl restart mwsnmpd</code></p>
<p>Verify status:</p>
<p><code># systemctl status mwsnmpd</code></p>
<p><b>Manually</b></p>
<p><code># export MWSNMPD_CONFIGURATION_FILE=/etc/mw-server/mwsnmpd.conf</code> <br />
 <code># export MW_CONNECTION_STRING=tcp://127.0.0.1:49154</code> <br />
 <code># export MW_APPLICATION_ID=10980</code> <br />
 <code># mwsnmpd -f -Lo -x tcp:localhost:705 -D ygkMiddlewareBridge</code></p>
<p>Note: The arguments <code>-D ygkMiddlewareBridge</code> is used for showing debugging messages of the ygkMiddlewareBridge module.</p>
<h1>Performing SNMP requests</h1>
<p><b>Requesting Service List table</b></p>
<p>Display service list table:</p>
<div class="fragment"><div class="line">$ snmptable -v 2c -c public -Ci -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::mwServiceList</div></div><!-- fragment --><p>Start a service:</p>
<div class="fragment"><div class="line">$ snmpset -v 2c -c public -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::lstStatus.10 s &quot;start&quot;</div></div><!-- fragment --><p>Stop a service:</p>
<div class="fragment"><div class="line">$ snmpset -v 2c -c public -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::lstStatus.10 s &quot;stop&quot;</div></div><!-- fragment --><p>Restart a service:</p>
<div class="fragment"><div class="line">$ snmpset -v 2c -c public -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::lstStatus.10 s &quot;restart&quot;</div></div><!-- fragment --><p><b>Requesting Service MIBs table</b></p>
<p>Display service MIBs table:</p>
<div class="fragment"><div class="line">$ snmptable -v 2c -c public -Ci -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::mwServiceMIBs</div></div><!-- fragment --><p><b>Requesting MIB Mappings</b></p>
<p>Get time-related informations from the PVT module:</p>
<div class="fragment"><div class="line">$ snmpget -v 2c -c public -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::pvtTimeNow YOGOKO-SNMP-MIB::pvtTimeUtc YOGOKO-SNMP-MIB::pvtTimeIts YOGOKO-SNMP-MIB::pvtLeapSeconds</div></div><!-- fragment --><p><b>Other operations</b></p>
<p>Dump all mapped MIBs (to be avoided in production):</p>
<div class="fragment"><div class="line">$ snmpwalk -v 2c -c public -m YOGOKO-SNMP-MIB \</div><div class="line">          -M /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf:/usr/share/mibs/site:/usr/share/snmp/mibs:/usr/share/mibs/iana:/usr/share/mibs/ietf:/usr/share/mibs/netsnmp:. \</div><div class="line">          localhost:11161 YOGOKO-SNMP-MIB::mwMIBModules</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Tue Mar 14 2023 16:13:25 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="yogoko-doxy.js"></script>
  </body>
</html>
