<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Traffic Light Application</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="yogoko.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="https://www.yogoko.com/"><img height="40px" src="yogoko-logo-svg-fr-white.png" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">YoGoKo Smart Middleware</span></p>
              <ul id="yogoko-navlist" class="nav navbar-nav"></ul>
              <form id="yogoko-searchform" class="navbar-form navbar-left navbar-right hidden-sm hidden-xs">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('trafficlight.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Traffic Light Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Traffic Light Application is a service that simulates the behavior of a basic Traffic Light, and instructs the SpatService for sending Spat and Map messages.</p>
<h1>Processing and I/O</h1>
<h2>General behavior</h2>
<p>The Traffic Light Application is configured with informations which are necessary for generating a Spat/Map intersection and timing data:</p><ul>
<li>the location of the intersection</li>
<li>the number and relative positioning of lanes of the intersection, and the signalgroup (identier for the traffic light) associated to all movements outgoing from this lane</li>
<li>the number and the matrix of each traffic light (identified by a signalgroup)</li>
</ul>
<p>Note that this service cannot simulate complex intersections, with different phases for all movements outgoing from a single lane. That is, a lane is assumed to have only one traffic light for all directions.</p>
<h2>Generation of Map messages</h2>
<p>The Map data is extracted from configuration sections <em><b>position</b></em> and <em><b>lane&lt;n&gt;</b></em>. The data is sent as is to the SpatService on pubsub message id identified by <em><b>pubsub.configspat</b></em>, at service startup.</p>
<p>Since this is static data, the message is never refreshed, unless configuration is modified.</p>
<p>The SpatService is responsible of building the Map message from the Map data and regularly re-emitting.</p>
<h2>Generation of Spat messages</h2>
<p>The Spat data is built from the matrix provided in configuration section <em><b>traffic&lt;n&gt;</b></em>. Based on this matrix, the Traffic Light Application computes absolute timestamps for current and next states of each signal group. The Traffic Light Application sends the list of next phase state changes to the SpatService on pubsub message id identified by <em><b>pubsub.configspat</b></em>. This list is regularly refreshed according to the total duration of the matrix.</p>
<p>Note: The user is in charge of ensuring the consistency of its matrix. The service makes no check to verify that phases respect standard timings.</p>
<h1>Configuration and MIBs</h1>
<h2>List of MIB entries</h2>
<p>Details of MIB entries:</p>
<table class="doxtable">
<tr>
<th>Section </th><th>Field </th><th>Description </th><th>Default value  </th></tr>
<tr>
<td>pubsub </td><td>configspat </td><td>Message ID to publish the Map and Spat data on for configuring the SpatService </td><td>54 </td></tr>
<tr>
<td>position </td><td>altitude </td><td>Altitude of this intersection </td><td></td></tr>
<tr>
<td>position </td><td>latitude </td><td>Latitude of this intersection </td><td></td></tr>
<tr>
<td>position </td><td>longitude </td><td>Longitude of this intersection </td><td></td></tr>
<tr>
<td>index </td><td>lanes </td><td>Number of declared lanes </td><td>0 </td></tr>
<tr>
<td>index </td><td>trafficlights </td><td>Number of declared signal groups </td><td>0 </td></tr>
<tr>
<td>lane&lt;n&gt; </td><td>id </td><td>ID of the declared lane </td><td></td></tr>
<tr>
<td>lane&lt;n&gt; </td><td>egress </td><td>Whether this lane may be used for egress traffic (leaving the intersection) </td><td>false </td></tr>
<tr>
<td>lane&lt;n&gt; </td><td>ingress </td><td>Whether this lane may be used for ingress traffic (entering the intersection) </td><td>false </td></tr>
<tr>
<td>lane&lt;n&gt; </td><td>node&lt;n&gt; </td><td>Node of the line positioning this lane </td><td></td></tr>
<tr>
<td>lane&lt;n&gt; </td><td>signalgroup </td><td>Signalgroup to use for all movements starting from this lane </td><td></td></tr>
<tr>
<td>traffic&lt;n&gt; </td><td>signalgroup </td><td>Signalgroup identifying this traffic light </td><td></td></tr>
<tr>
<td>traffic&lt;n&gt; </td><td>length </td><td>Length of the signal phases matrix (length of s&lt;n&gt; and t&lt;n&gt;) </td><td>0 </td></tr>
<tr>
<td>traffic&lt;n&gt; </td><td>s&lt;n&gt; </td><td>Signal phase ID for this matrix element (according to the SPAT standard) </td><td></td></tr>
<tr>
<td>traffic&lt;n&gt; </td><td>t&lt;n&gt; </td><td>Duration in seconds of this phase </td><td></td></tr>
</table>
<h2>Sample configuration file</h2>
<p><em><b>config/60-trafficlight.xml</b></em></p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">encoding</span>=<span class="stringliteral">&quot;utf-8&quot;</span>?&gt;</div><div class="line">&lt;<span class="keywordtype">configuration</span>&gt;</div><div class="line">    <span class="comment">&lt;!--</span></div><div class="line"><span class="comment">        TrafficLight</span></div><div class="line"><span class="comment">        Virtual traffic light, configured with a static matrix</span></div><div class="line"><span class="comment">    --&gt;</span></div><div class="line">    &lt;<span class="keywordtype">service</span> <span class="keyword">start</span>=<span class="stringliteral">&quot;false&quot;</span> <span class="keyword">instance</span>=<span class="stringliteral">&quot;0&quot;</span>&gt;<span class="keyword">TrafficLight</span>&lt;/<span class="keywordtype">service</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">config</span>&gt;</div><div class="line">        <span class="comment">&lt;!-- Parameters for the pubsub mechanism (reasonable defaults) --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">pubsub</span> <span class="keyword">configspat</span>=<span class="stringliteral">&quot;54&quot;</span>/&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Reference position of the intersection</span></div><div class="line"><span class="comment">            latitude: latitude of the intersection</span></div><div class="line"><span class="comment">            longitude: longitude of the intersection</span></div><div class="line"><span class="comment">            altitude: altitude of the intersection</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">position</span> <span class="keyword">latitude</span>=<span class="stringliteral">&quot;48.1350568&quot;</span></div><div class="line">                  <span class="keyword">longitude</span>=<span class="stringliteral">&quot;-1.6221928&quot;</span></div><div class="line">                  <span class="keyword">altitude</span>=<span class="stringliteral">&quot;0&quot;</span> /&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!-- Traffic lights matrix and lanes</span></div><div class="line"><span class="comment">            lanes: number of lanes</span></div><div class="line"><span class="comment">            trafficlights: number of traffic light</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">index</span> <span class="keyword">lanes</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">trafficlights</span>=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!--    configuration of lanes (starting from 0)</span></div><div class="line"><span class="comment">                id: id of the lane</span></div><div class="line"><span class="comment">                ingress: whether the lane allows traffic from outside to the intersection</span></div><div class="line"><span class="comment">                egress: whether the lane allows traffic from the intersection to outside</span></div><div class="line"><span class="comment">                signalgroup: signalgroup associated to this lane (if ingress)</span></div><div class="line"><span class="comment">                nodex: coordinates of the lane (m)</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">lane0</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">ingress</span>=<span class="stringliteral">&quot;true&quot;</span> <span class="keyword">signalgroup</span>=<span class="stringliteral">&quot;89&quot;</span></div><div class="line">               <span class="keyword">node1</span>=<span class="stringliteral">&quot;-80;-90&quot;</span> <span class="keyword">node2</span>=<span class="stringliteral">&quot;-100;-120&quot;</span> /&gt;</div><div class="line">        &lt;<span class="keywordtype">lane1</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">egress</span>=<span class="stringliteral">&quot;true&quot;</span></div><div class="line">               <span class="keyword">node1</span>=<span class="stringliteral">&quot;30;20&quot;</span> <span class="keyword">node2</span>=<span class="stringliteral">&quot;50;40&quot;</span> /&gt;</div><div class="line">        &lt;<span class="keywordtype">lane2</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">ingress</span>=<span class="stringliteral">&quot;true&quot;</span> <span class="keyword">signalgroup</span>=<span class="stringliteral">&quot;89&quot;</span></div><div class="line">               <span class="keyword">node1</span>=<span class="stringliteral">&quot;70;-90&quot;</span> <span class="keyword">node2</span>=<span class="stringliteral">&quot;100;-120&quot;</span> /&gt;</div><div class="line">        &lt;<span class="keywordtype">lane3</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">egress</span>=<span class="stringliteral">&quot;true&quot;</span></div><div class="line">               <span class="keyword">node1</span>=<span class="stringliteral">&quot;-60;40&quot;</span> <span class="keyword">node2</span>=<span class="stringliteral">&quot;-80;60&quot;</span> /&gt;</div><div class="line"></div><div class="line">        <span class="comment">&lt;!--    configuration of traffic lights (starting from 0)</span></div><div class="line"><span class="comment">                signalgroup: id of the signalgroup</span></div><div class="line"><span class="comment">                length: number of states</span></div><div class="line"><span class="comment">                tx: duration of the phase x (s)</span></div><div class="line"><span class="comment">                sx: the state of the phase x (according to J2735)</span></div><div class="line"><span class="comment">        --&gt;</span></div><div class="line">        &lt;<span class="keywordtype">traffic0</span> <span class="keyword">signalgroup</span>=<span class="stringliteral">&quot;89&quot;</span> <span class="keyword">length</span>=<span class="stringliteral">&quot;3&quot;</span></div><div class="line">                  <span class="keyword">t0</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">t1</span>=<span class="stringliteral">&quot;26&quot;</span> <span class="keyword">t2</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">s0</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">s1</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">s2</span>=<span class="stringliteral">&quot;7&quot;</span>/&gt;</div><div class="line">        &lt;<span class="keywordtype">traffic1</span> <span class="keyword">signalgroup</span>=<span class="stringliteral">&quot;111&quot;</span> <span class="keyword">length</span>=<span class="stringliteral">&quot;3&quot;</span></div><div class="line">                  <span class="keyword">t0</span>=<span class="stringliteral">&quot;26&quot;</span> <span class="keyword">t1</span>=<span class="stringliteral">&quot;2&quot;</span> <span class="keyword">t2</span>=<span class="stringliteral">&quot;32&quot;</span> <span class="keyword">s0</span>=<span class="stringliteral">&quot;6&quot;</span> <span class="keyword">s1</span>=<span class="stringliteral">&quot;7&quot;</span> <span class="keyword">s2</span>=<span class="stringliteral">&quot;3&quot;</span>/&gt;</div><div class="line">    &lt;/<span class="keywordtype">config</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">configuration</span>&gt;</div></div><!-- fragment --><h1>Usage example</h1>
<p>The default configuration file provides an example of an intersection supported by the TrafficLight Application. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Tue Mar 14 2023 16:13:25 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="yogoko-doxy.js"></script>
  </body>
</html>
